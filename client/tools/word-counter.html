<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Word Counter - Tools Website</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="../css/style.css" rel="stylesheet">
</head>
<body>
    <div class="dotted-background"></div>
    
    <nav class="navbar navbar-expand-lg">
        <div class="container">
            <a class="navbar-brand" href="/">
                <i class="fas fa-tools me-2"></i>
                Tools Website
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="/">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/tools/pdf-to-docx">PDF to DOCX</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/tools/docx-to-pdf">DOCX to PDF</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <main class="container my-5">
        <!-- Header -->
        <div class="text-center mb-5">
            <h1 class="display-5 mb-3">
                <i class="fas fa-calculator me-3"></i>
                Word Counter & Text Analyzer
            </h1>
            <p class="lead">Analyze your text with detailed statistics and insights</p>
        </div>

        <!-- Main Tool Container -->
        <div class="row">
            <div class="col-lg-8">
                <div class="tool-container word-counter-container">
                    <!-- Alert Container -->
                    <div id="alertContainer" class="mb-4"></div>

                    <!-- Text Input Section -->
                    <div class="mb-4">
                        <h3 class="mb-3">
                            <i class="fas fa-edit me-2"></i>
                            Enter Your Text
                        </h3>
                        
                        <textarea 
                            id="textInput" 
                            class="form-control" 
                            rows="12" 
                            placeholder="Type or paste your text here to get real-time word count and analysis..."
                            style="font-size: 16px; line-height: 1.6;"
                        ></textarea>
                        
                        <div class="d-flex justify-content-between mt-2">
                            <small class="text-muted">Start typing to see live statistics</small>
                            <button id="clearBtn" class="btn btn-sm btn-secondary">
                                <i class="fas fa-eraser me-1"></i>
                                Clear Text
                            </button>
                        </div>
                    </div>

                    <!-- Quick Actions -->
                    <div class="text-center mb-4">
                        <button id="sampleTextBtn" class="btn btn-secondary me-2">
                            <i class="fas fa-file-alt me-2"></i>
                            Load Sample Text
                        </button>
                        <button id="analyzeBtn" class="btn btn-primary">
                            <i class="fas fa-search me-2"></i>
                            Deep Analysis
                        </button>
                    </div>
                </div>
            </div>

            <!-- Statistics Panel -->
            <div class="col-lg-4">
                <div class="tool-container">
                    <h3 class="mb-4">
                        <i class="fas fa-chart-bar me-2"></i>
                        Statistics
                    </h3>
                    
                    <div class="stats-grid">
                        <div class="stat-card">
                            <span id="wordCount" class="stat-number">0</span>
                            <span class="stat-label">Words</span>
                        </div>
                        
                        <div class="stat-card">
                            <span id="charCount" class="stat-number">0</span>
                            <span class="stat-label">Characters</span>
                        </div>
                        
                        <div class="stat-card">
                            <span id="charNoSpacesCount" class="stat-number">0</span>
                            <span class="stat-label">Chars (No Spaces)</span>
                        </div>
                        
                        <div class="stat-card">
                            <span id="sentenceCount" class="stat-number">0</span>
                            <span class="stat-label">Sentences</span>
                        </div>
                        
                        <div class="stat-card">
                            <span id="paragraphCount" class="stat-number">0</span>
                            <span class="stat-label">Paragraphs</span>
                        </div>
                        
                        <div class="stat-card">
                            <span id="lineCount" class="stat-number">0</span>
                            <span class="stat-label">Lines</span>
                        </div>
                        
                        <div class="stat-card">
                            <span id="avgWords" class="stat-number">0</span>
                            <span class="stat-label">Avg Words/Sentence</span>
                        </div>
                        
                        <div class="stat-card">
                            <span id="readingTime" class="stat-number">0</span>
                            <span class="stat-label">Reading Time (min)</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Most Common Words Section -->
        <div class="row mt-4">
            <div class="col-12">
                <div class="tool-container">
                    <h3 class="mb-4">
                        <i class="fas fa-list-ol me-2"></i>
                        Most Common Words
                    </h3>
                    <div id="commonWordsContainer">
                        <p class="text-muted text-center py-4">
                            <i class="fas fa-info-circle me-2"></i>
                            Enter some text above to see the most frequently used words
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Back to Home -->
        <div class="text-center mt-5">
            <a href="/" class="btn btn-secondary">
                <i class="fas fa-home me-2"></i>
                Back to Home
            </a>
        </div>
    </main>

    <footer class="mt-5 py-4 text-center">
        <div class="container">
            <p>&copy; 2024 Tools Website. All rights reserved.</p>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../js/main.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Initialize elements
            const textInput = document.getElementById('textInput');
            const clearBtn = document.getElementById('clearBtn');
            const sampleTextBtn = document.getElementById('sampleTextBtn');
            const analyzeBtn = document.getElementById('analyzeBtn');
            const alertContainer = document.getElementById('alertContainer');
            const commonWordsContainer = document.getElementById('commonWordsContainer');

            // Statistics elements
            const wordCount = document.getElementById('wordCount');
            const charCount = document.getElementById('charCount');
            const charNoSpacesCount = document.getElementById('charNoSpacesCount');
            const sentenceCount = document.getElementById('sentenceCount');
            const paragraphCount = document.getElementById('paragraphCount');
            const lineCount = document.getElementById('lineCount');
            const avgWords = document.getElementById('avgWords');
            const readingTime = document.getElementById('readingTime');

            let analysisTimeout = null;

            // Sample text for demonstration
            const sampleText = `This is a sample text for demonstration purposes. It contains multiple sentences and paragraphs to show how the word counter tool works.

The word counter analyzes various aspects of your text including word count, character count, sentence count, and reading time. This helps writers, students, and professionals understand their text better.

You can use this tool to:
- Count words and characters
- Analyze sentence structure  
- Estimate reading time
- Find most common words
- Track writing progress

Try typing or pasting your own text to see real-time analysis!`;

            // Real-time text analysis
            function analyzeText(text, showCommonWords = false) {
                // Clear previous timeout
                if (analysisTimeout) {
                    clearTimeout(analysisTimeout);
                }

                // Basic real-time counts (local calculation)
                const basicStats = calculateBasicStats(text);
                updateBasicStats(basicStats);

                // Debounced detailed analysis
                if (showCommonWords) {
                    analysisTimeout = setTimeout(async () => {
                        try {
                            const result = await ApiClient.countWords(text);
                            if (result.success) {
                                updateDetailedStats(result.data);
                                updateCommonWords(result.data.most_common_words);
                            }
                        } catch (error) {
                            console.error('Analysis error:', error);
                        }
                    }, 500);
                }
            }

            // Calculate basic stats locally for real-time updates
            function calculateBasicStats(text) {
                const words = text.trim() ? text.trim().split(/\s+/).length : 0;
                const characters = text.length;
                const charactersNoSpaces = text.replace(/\s/g, '').length;
                const lines = text.split('\n').length;
                const sentences = text.trim() ? (text.match(/[.!?]+/g) || []).length : 0;
                const paragraphs = text.trim() ? text.split(/\n\s*\n/).filter(p => p.trim()).length : 0;
                
                return {
                    words,
                    characters,
                    characters_no_spaces: charactersNoSpaces,
                    lines,
                    sentences: sentences || (text.trim() ? 1 : 0),
                    paragraphs: paragraphs || (text.trim() ? 1 : 0),
                    average_words_per_sentence: sentences ? (words / sentences).toFixed(1) : 0,
                    reading_time_minutes: (words / 200).toFixed(1)
                };
            }

            // Update basic statistics display
            function updateBasicStats(stats) {
                wordCount.textContent = stats.words;
                charCount.textContent = stats.characters;
                charNoSpacesCount.textContent = stats.characters_no_spaces;
                sentenceCount.textContent = stats.sentences;
                paragraphCount.textContent = stats.paragraphs;
                lineCount.textContent = stats.lines;
                avgWords.textContent = stats.average_words_per_sentence;
                readingTime.textContent = stats.reading_time_minutes;
            }

            // Update detailed statistics from API
            function updateDetailedStats(data) {
                wordCount.textContent = data.words;
                charCount.textContent = data.characters;
                charNoSpacesCount.textContent = data.characters_no_spaces;
                sentenceCount.textContent = data.sentences;
                paragraphCount.textContent = data.paragraphs;
                lineCount.textContent = data.lines;
                avgWords.textContent = data.average_words_per_sentence;
                readingTime.textContent = data.reading_time_minutes;
            }

            // Update common words display
            function updateCommonWords(commonWords) {
                if (commonWords && commonWords.length > 0) {
                    const wordsHTML = commonWords.map((item, index) => `
                        <div class="d-flex justify-content-between align-items-center py-2 border-bottom">
                            <span class="fw-bold">${index + 1}. ${item.word}</span>
                            <span class="badge bg-dark">${item.count}</span>
                        </div>
                    `).join('');
                    
                    commonWordsContainer.innerHTML = `
                        <div class="row">
                            <div class="col-12">
                                <h5 class="mb-3">Top ${commonWords.length} Most Used Words</h5>
                                ${wordsHTML}
                            </div>
                        </div>
                    `;
                } else {
                    commonWordsContainer.innerHTML = `
                        <p class="text-muted text-center py-4">
                            <i class="fas fa-info-circle me-2"></i>
                            Enter some text above to see the most frequently used words
                        </p>
                    `;
                }
            }

            // Event listeners
            textInput.addEventListener('input', (e) => {
                analyzeText(e.target.value, false);
            });

            textInput.addEventListener('paste', (e) => {
                setTimeout(() => {
                    analyzeText(e.target.value, true);
                }, 100);
            });

            clearBtn.addEventListener('click', () => {
                textInput.value = '';
                analyzeText('');
                updateCommonWords([]);
                Utils.showAlert(alertContainer, 'Text cleared successfully!', 'info');
            });

            sampleTextBtn.addEventListener('click', () => {
                textInput.value = sampleText;
                analyzeText(sampleText, true);
                Utils.showAlert(alertContainer, 'Sample text loaded. Try editing it to see real-time updates!', 'success');
            });

            analyzeBtn.addEventListener('click', async () => {
                const text = textInput.value.trim();
                
                if (!text) {
                    Utils.showAlert(alertContainer, 'Please enter some text to analyze.', 'danger');
                    return;
                }

                try {
                    Utils.showLoading(analyzeBtn, 'Analyzing...');
                    
                    const result = await ApiClient.countWords(text);
                    
                    if (result.success) {
                        updateDetailedStats(result.data);
                        updateCommonWords(result.data.most_common_words);
                        Utils.showAlert(alertContainer, 'Deep analysis completed!', 'success');
                    } else {
                        Utils.showAlert(alertContainer, 'Analysis failed. Please try again.', 'danger');
                    }
                } catch (error) {
                    Utils.showAlert(alertContainer, error.message, 'danger');
                } finally {
                    Utils.hideLoading(analyzeBtn);
                }
            });

            // Initialize with empty state
            analyzeText('');
        });
    </script>
</body>
</html>
